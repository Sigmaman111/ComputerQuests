<script>
    const maxXP = 100;

    const currentUser = localStorage.getItem("currentUser");
    if (!currentUser) {
        // No user logged in â†’ redirect to login page
        window.location.href = "auth.html";
    }

    // Load saved XP or default to 0
    let xp = parseInt(localStorage.getItem("xp_" + currentUser) || "0");

    function saveXP() {
        localStorage.setItem("xp_" + currentUser, xp);
    }

    // Create boxes
    const grid = document.querySelector(".grid");
    for (let i = 1; i <= 20; i++) {
        const b = document.createElement("div");
        b.className = "box";
        b.textContent = "Box " + i + " (Click for XP)";
        b.addEventListener("click", () => addXP(5));
        grid.appendChild(b);
    }

    // Fill bar on load
    updateXPBar();

    function addXP(amount) {
        xp = Math.min(maxXP, xp + amount);
        saveXP();
        updateXPBar();
    }

    function updateXPBar() {
        const percent = (xp / maxXP) * 100;
        document.getElementById("xpBar").style.width = percent + "%";
        document.getElementById("xpText").textContent = `XP: ${xp} / ${maxXP}`;
    }
</script>
